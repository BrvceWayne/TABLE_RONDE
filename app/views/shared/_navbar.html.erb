<%#
  MENU BURGER FLOTTANT - Ultra minimaliste

  Juste un bouton burger flottant en haut √† droite
  Pas de header visible, se fond dans le d√©cor
%>

<div data-controller="menu user-menu" data-action="keydown.escape@window->menu#closeOnEscape keydown.escape@window->user-menu#close">
  <%# Header flottant avec burger + user info %>
  <div class="floating-header">
    <%# Bouton burger (ic√¥ne hamburger food) %>
    <button
      class="burger-floating"
      data-menu-target="burger"
      data-action="click->menu#toggle"
      aria-label="Menu"
      aria-expanded="false"
    >
      <span class="burger-icon">
        <span class="burger-icon__bun-top"></span>
        <span class="burger-icon__lettuce"></span>
        <span class="burger-icon__patty"></span>
        <span class="burger-icon__bun-bottom"></span>
      </span>
      <span class="burger-icon__cross">
        <span class="burger-icon__cross-line"></span>
        <span class="burger-icon__cross-line"></span>
      </span>
    </button>

    <% if user_signed_in? %>
      <%# Menu utilisateur avec dropdown %>
      <div class="user-dropdown" data-user-menu-target="container">
        <button
          class="floating-header__user"
          data-action="click->user-menu#toggle"
          aria-label="Menu utilisateur"
          aria-expanded="false"
        >
          <span class="floating-header__name"><%= current_user.email.split('@').first.capitalize %></span>
          <span class="avatar avatar-sm">
            <%= current_user.email.first.upcase %>
          </span>
        </button>

        <%# Dropdown menu %>
        <div class="user-dropdown__menu" data-user-menu-target="menu">
          <div class="user-dropdown__header">
            <span class="avatar">
              <%= current_user.email.first.upcase %>
            </span>
            <div class="user-dropdown__info">
              <span class="user-dropdown__name"><%= current_user.email.split('@').first.capitalize %></span>
              <span class="user-dropdown__email"><%= current_user.email %></span>
            </div>
          </div>

          <div class="user-dropdown__divider"></div>

          <nav class="user-dropdown__nav">
            <%= link_to "#", class: "user-dropdown__link", data: { action: "click->user-menu#close" } do %>
              <i class="fa-solid fa-user"></i>
              Mon profil
            <% end %>
            <%= link_to "#", class: "user-dropdown__link", data: { action: "click->user-menu#close" } do %>
              <i class="fa-solid fa-gear"></i>
              Param√®tres
            <% end %>
          </nav>

          <div class="user-dropdown__divider"></div>

          <%= link_to destroy_user_session_path,
                      data: { turbo_method: :delete, action: "click->user-menu#close" },
                      class: "user-dropdown__link user-dropdown__link--danger" do %>
            <i class="fa-solid fa-right-from-bracket"></i>
            Se d√©connecter
          <% end %>
        </div>
      </div>
    <% else %>
      <%# Boutons connexion/inscription %>
      <div class="floating-header__auth">
        <%= link_to "Connexion", new_user_session_path, class: "btn btn-sm btn-outline" %>
      </div>
    <% end %>
  </div>

  <%# Overlay %>
  <div
    class="menu-overlay"
    data-menu-target="overlay"
    data-action="click->menu#closeOnOverlay"
  ></div>

  <%# Menu plein √©cran %>
  <nav class="menu-fullscreen" data-menu-target="menu">
    <%# Logo en haut du menu %>
    <div class="menu-fullscreen__header">
      <%= link_to root_path, class: "menu-fullscreen__logo", data: { action: "click->menu#close" } do %>
        <span class="logo-text">
          TableR<span class="logo-icon">
            <span class="logo-icon__fork"></span>
            <span class="logo-icon__circle"></span>
            <span class="logo-icon__knife"></span>
          </span>nde
        </span>
      <% end %>
    </div>

    <div class="menu-fullscreen__content">
      <ul class="menu-fullscreen__nav">
        <li>
          <%= link_to root_path, class: "menu-fullscreen__link", data: { action: "click->menu#close" } do %>
            <span class="menu-fullscreen__icon">üè†</span>
            Accueil
          <% end %>
        </li>
        <% if user_signed_in? %>
          <li>
            <%= link_to sessions_path, class: "menu-fullscreen__link", data: { action: "click->menu#close" } do %>
              <span class="menu-fullscreen__icon">üìÖ</span>
              Mes sessions
            <% end %>
          </li>
        <% end %>
        <li>
          <%= link_to "#", class: "menu-fullscreen__link", data: { action: "click->menu#close" } do %>
            <span class="menu-fullscreen__icon">‚ùì</span>
            Comment √ßa marche
          <% end %>
        </li>
        <li>
          <%= link_to "#", class: "menu-fullscreen__link", data: { action: "click->menu#close" } do %>
            <span class="menu-fullscreen__icon">üìß</span>
            Contact
          <% end %>
        </li>
      </ul>

      <% unless user_signed_in? %>
        <div class="menu-fullscreen__actions">
          <%= link_to "Se connecter", new_user_session_path,
                      class: "btn btn-outline btn-block",
                      data: { action: "click->menu#close" } %>
          <%= link_to "S'inscrire", new_user_registration_path,
                      class: "btn btn-primary btn-block",
                      data: { action: "click->menu#close" } %>
        </div>
      <% end %>
    </div>

    <div class="menu-fullscreen__footer">
      <span class="tagline">On mange o√π ?</span>
    </div>
  </nav>
</div>
